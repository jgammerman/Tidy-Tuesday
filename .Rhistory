pairwise_cor(country, rcid, vote, use = "pairwise.complete.obs", sort = TRUE)
cors
UK_cors <- cors %>%
filter(item1 == "United Kingdom")
UK_cors
UK_cors %>% head(20)
country_correlations %>%
filter(item1 == "United Kingdom") %>%
slice(c(1:16, n() - 0:15)) %>%
mutate(country = fct_reorder(item2, correlation)) %>%
ggplot(aes(correlation, country)) +
geom_errorbarh(height = 0, aes(xmin = correlation, xmax = 0)) +
geom_point() +
labs(x = "How much this country's voting is correlated with the UK",
y = "")
cors <- un_votes %>%
mutate(vote = as.numeric(vote)) %>%
pairwise_cor(country, rcid, vote, use = "pairwise.complete.obs", sort = TRUE)
cors
UK_cors <- cors %>%
filter(item1 == "United Kingdom")
UK_cors %>% head(20)
country_correlations %>%
filter(item1 == "United Kingdom") %>%
slice(c(1:16, n() - 0:15)) %>%
mutate(country = fct_reorder(item2, correlation)) %>%
ggplot(aes(correlation, country)) +
geom_errorbarh(height = 0, aes(xmin = correlation, xmax = 0)) +
geom_point() +
labs(x = "How much this country's voting is correlated with the UK",
y = "")
UK_cors <- cors %>%
filter(item1 == "United States")
US_cors <- cors %>%
filter(item1 == "United States")
US_cors %>% head(20)
View(unvotes)
View(unvotes)
country_correlations %>%
filter(item1 == "United Kingdom") %>%
slice(c(1:16, n() - 0:15)) %>%
mutate(country = fct_reorder(item2, correlation)) %>%
ggplot(aes(correlation, country)) +
geom_errorbarh(height = 0, aes(xmin = correlation, xmax = 0)) +
geom_point() +
labs(x = "How much this country's voting is correlated with the UK",
y = "")
library(ggraph)
library(igraph)
cors_filtered <- cors %>%
filter(correlation > .6)
continents <- tibble(country = unique(un_votes$country)) %>%
filter(country %in% cors_filtered$item1 |
country %in% cors_filtered$item2) %>%
mutate(continent = countrycode(country, "country.name", "continent"))
set.seed(2017)
cors_filtered %>%
graph_from_data_frame(vertices = continents) %>%
ggraph() +
geom_edge_link(aes(edge_alpha = correlation)) +
geom_node_point(aes(color = continent), size = 3) +
geom_node_text(aes(label = name), check_overlap = TRUE, vjust = 1, hjust = 1) +
theme_void() +
labs(title = "Network of countries with correlated United Nations votes")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(scales)
theme_set(theme_light())
tt <- tt_load("2021-03-23")
tt %>%
map(glimpse)
View(tt)
tt
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(scales)
theme_set(theme_light())
tt <- tt_load("2021-03-23")
unvotes <- tt$unvotes
unvotes %>% count(vote, sort = TRUE)
unvotes %>% count(country, sort = TRUE)
issues <- tt$issues
)
glimpse(issues
glimpse(issues)
issues <- tt$issues
glimpse(issues)
View(issues)
count(issues, issue, sort = TRUE)
unvotes_issues <- tt$unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")) - 2) %>%
left_join(issues %>%
select(rcid, issue), by = "rcid")
unvotes_issues
View(unvotes_issues)
View(unvotes)
View(issues)
glimpse(unvotes)
str(unvotes)
summary(unvotes)
summary(issue)
summary(issues)
roll_calls <- tt$roll_calls
glimpse(roll_calls)
View(roll_calls)
View(unvotes_issues)
unvotes_issues %>%
distinct(rcid)
unvotes_issues %>%
distinct(rcid, issue)
View(issues)
View(roll_calls)
unvotes_issues %>%
distinct(rcid, issue) %>%
ggplot(aes(issue)) +
geom_bar()
votes_by_issue <- unvotes_issues %>%
filter(!is.na(issue)) %>%
distinct(rcid, issue)
votes_by_issue
votes_by_issue %>%
ggplot(aes(issue)) +
geom_col()
votes_by_issue %>%
ggplot(aes(issue)) +
geom_col()
votes_by_issue %>% count()
votes_by_issue %>% count(issue)
votes_by_issue %>% count(issue, sort = TRUE)
votes_by_issue %>%
count(issue, sort = TRUE) %>%
ggplot(aes(issue)) +
geom_col()
votes_by_issue %>%
count(issue, sort = TRUE) %>%
ggplot(aes(issue, n)) +
geom_col()
votes_by_issue %>%
count(issue, sort = TRUE) %>%
ggplot(aes(issue, n)) +
geom_bar()
col()
votes_by_issue %>%
count(issue, sort = TRUE) %>%
ggplot(aes(issue, n)) +
geom_col()
votes_by_issue %>%
count(issue, sort = TRUE) %>%
mutate(issue = fct_reorder(issue, n)) %>%
ggplot(aes(issue, n)) +
geom_col()
votes_by_issue %>%
count(issue, sort = TRUE) %>%
mutate(issue = fct_reorder(issue, -n)) %>%
ggplot(aes(issue, n)) +
geom_col()
skimr::skim(unvotes_issues)
unvotes_issues_rollcalls <- unvotes%>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")) - 2) %>%
left_join(issues %>%
select(rcid, issue), by = "rcid") %>%
left_join(roll_calls %>%
select(rcid, date), by = "rcid")
unvotes_issues_rollcalls
View(unvotes_issues_rollcalls)
glimpse(unvotes_issues_rollcalls)
unvotes_issues_rollcalls %>%
mutate(year = lubridate::year(date))
tbl <- unvotes_issues_rollcalls %>%
mutate(year = lubridate::year(date),
decade = 10 * (year %/% 10))
tbl
View(tbl)
tbl %>%
distinct(rcid, decade, issue)
tbl2 <- tbl %>%
distinct(rcid, decade, issue)
tbl2
View(tbl2)
tbl2 %>%
group_by(rcid, issue, decade) %>%
summarise(n = n())
tbl2 %>%
group_by(issue, decade) %>%
summarise(n = n())
tbl2 %>%
group_by(issue, decade) %>%
summarise(Count = n()) %>%
ggplot()
tbl2 %>%
group_by(issue, decade) %>%
summarise(Count = n()) %>%
ggplot(aes(fill = issue))
tbl2 %>%
group_by(issue, decade) %>%
summarise(Count = n())
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(aes(x = issue, y = count))) +
geom_col(aes(fill = issue))
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n())
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = issue, y = count)) +
geom_col(aes(fill = issue))
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = issue, y = count)) +
geom_col(aes(fill = decade))
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_col(aes(fill = issue))
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(fill = issue))
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(color= issue)
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(color= issue)
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n())
geom_line((aes(color= issue))
tbl2 %>%
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color= issue))
tbl2 <- tbl %>%
distinct(rcid, decade, issue) %>%
filter(!is.na(issue))
tbl2
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_col(aes(fill = issue))
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color= issue))
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color= issue)) +
geom_point(aes(color=decade))
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n())
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color= issue))
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line() +
facet_wrap(~issue)
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(color=issue) +
facet_wrap(~issue)
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n())
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(color = issue) +
facet_wrap(~issue)
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color = issue) )+
facet_wrap(~issue)
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
mutate(issue = fct_reorder(issue, n)) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color = issue))+
facet_wrap(~issue)
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n())
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
mutate(issue = fct_reorder(issue, count)) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color = issue))+
facet_wrap(~issue)
tbl2 %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
mutate(issue = fct_reorder(issue, count)) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color = issue))+
facet_wrap(~issue) +
theme(legend.position = "none")
library(tidytuesdayR)
tidytuesdayR::use_tidytemplate()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(scales)
theme_set(theme_light())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
theme_set(theme_light())
## Load the data
Dowload the weekly data and make available in the `tt` object.
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
theme_set(theme_light())
## Load the data
tt <- tt_load("2021-03-23")
View(tt)
tt$issues %>%
select(rcid, issue) %>%
left_join(ttroll_calls %>%
select(rcid, date), by = "rcid")
issues_rollcalls <- tt$issues %>%
select(rcid, issue) %>%
left_join(tt$roll_calls %>%
select(rcid, date), by = "rcid")
issues_rollcalls
View(issues_rollcalls)
View(issues_rollcalls)
issues_rollcalls <- tt$issues %>%
select(rcid, issue) %>%
inner_join(tt$roll_calls %>%
select(rcid, date), by = "rcid")
issues_rollcalls <- tt$issues %>%
select(rcid, issue) %>%
inner_join(tt$roll_calls %>%
select(rcid, date), by = "rcid")
issues_rollcalls
View(issues_rollcalls)
issues_rollcalls <- tt$issues %>%
select(rcid, issue) %>%
inner_join(tt$roll_calls %>%
select(rcid, date), by = "rcid") %>%
mutate(year = lubridate::year(date),
decade = 10 * (year %/% 10))
issues_rollcalls
issues_rollcalls <- tt$issues %>%
select(rcid, issue) %>%
inner_join(tt$roll_calls %>%
select(rcid, date), by = "rcid") %>%
mutate(year = lubridate::year(date),
decade = 10 * (year %/% 10)) %>%
select(-year)
issues_rollcalls
issues_rollcalls %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
mutate(issue = fct_reorder(issue, count)) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color = issue))+
facet_wrap(~issue) +
theme(legend.position = "none")
issues_rollcalls
?mutate_if
?across
issues_rollcalls %>%
arrange(rcid)
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
filter(issue = "Palestinian Conflict")
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
filter(issue = "Palestinian conflict")
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
filter(issue == "Palestinian conflict")
issues_rollcalls <- tt$issues %>%
select(rcid, issue) %>%
inner_join(tt$roll_calls %>%
select(rcid, date), by = "rcid") %>%
mutate(year = lubridate::year(date),
decade = 10 * (year %/% 10)) %>%
select(-year, -decade)
issues_rollcalls <- tt$issues %>%
select(rcid, issue) %>%
inner_join(tt$roll_calls %>%
select(rcid, date), by = "rcid") %>%
mutate(year = lubridate::year(date),
decade = 10 * (year %/% 10)) %>%
select(-year, -decade)
issues_rollcalls
issues_rollcalls <- tt$issues %>%
select(rcid, issue) %>%
inner_join(tt$roll_calls %>%
select(rcid, date), by = "rcid") %>%
mutate(year = lubridate::year(date),
decade = 10 * (year %/% 10)) %>%
select(-year, -date)
issues_rollcalls <- tt$issues %>%
select(rcid, issue) %>%
inner_join(tt$roll_calls %>%
select(rcid, date), by = "rcid") %>%
mutate(year = lubridate::year(date),
decade = 10 * (year %/% 10)) %>%
select(-year, -date)
issues_rollcalls
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
filter(issue == "Palestinian conflict")
issues_rollcalls
issues_rollcalls %>%
arrange(rcid)
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
filter(issue == "Colonialism")
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
summarise(rcid_about_palestine = issue == "Palestinian conflict")
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
summarise(rcid_about_palestine = issue == "Colonialism")
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
summarise(rcid_about_palestine = issue == "Colonialism") %>%
ungroup() %>%
group_by(rcid) %>%
summarise(av = mean(rcid_about_palestine))
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
summarise(rcid_about_palestine = issue == "Colonialism") %>%
ungroup() %>%
summarise(av = mean(rcid_about_palestine))
issues_rollcalls %>%
arrange(rcid) %>%
group_by(rcid) %>%
summarise(rcid_about_palestine = issue == "Colonialism") %>%
ungroup()
issues_rollcalls %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
mutate(issue = fct_reorder(issue, count)) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color = issue))+
facet_wrap(~issue) +
theme(legend.position = "none") +
labs(x = "Decade", y = "Number of roll calls in decade")
issues_rollcalls %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
#        mutate(issue = fct_reorder(issue, count)) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color = issue))+
facet_wrap(~issue) +
theme(legend.position = "none") +
labs(x = "Decade", y = "Number of roll calls in decade", title = )
tt
issues_rollcalls %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color = issue))+
facet_wrap(~issue) +
theme(legend.position = "none") +
labs(x = "Decade", y = "Number of votes in decade", title = "Historic UN Votes By Issue")
issues_rollcalls %>%
group_by(issue, decade) %>%
summarise(count = n())
issues_rollcalls %>%
group_by(issue, decade) %>%
summarise(count = n()) %>%
ggplot(aes(x = decade, y = count)) +
geom_line(aes(color = issue))+
facet_wrap(~issue) +
theme(legend.position = "none") +
labs(x = "Decade", y = "Number of votes in decade", title = "Historic UN Votes By Issue")
