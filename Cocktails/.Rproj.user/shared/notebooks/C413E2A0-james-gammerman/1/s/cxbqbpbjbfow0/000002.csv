"0","library(tidytext)"
"0",""
"0","tidied_pca %>%"
"0","  filter(component %in% paste0(""PC"", 1:4)) %>%"
"0","  group_by(component) %>%"
"0","  top_n(8, abs(value)) %>%"
"0","  ungroup() %>%"
"0","  mutate(terms = reorder_within(terms, by = abs(value), within = component)) %>%  # from tidytext package - reorders column before plotting with faceting, such that the values are ordered within each facet...needs scale_x_reordered or scale_y_reordered to be used laster"
"0","  ggplot(aes(abs(value), terms, fill = value > 0)) +"
"0","  geom_col() +"
"0","  facet_wrap(~component, , scales = ""free_y"") +"
"0","  scale_y_reordered() +  # see earlier comment"
"0","  labs("
"0","    x = ""Absolute value of contribution"","
"0","    y = NULL, fill = ""Positive?"""
"0","  )"
